---
import LoginIcon from "../icons/LoginIcon.astro";
import ZoomInIcon from "../icons/ZoomInIcon.astro";
---

<section
  class="my-24 flex flex-col max-w-4xl mx-auto overflow-hidden bg-white rounded-lg shadow-lg dark:bg-[#191919] md:flex-row md:h-48"
>
  <!-- Contenido del formulario de búsqueda -->
  <div
    class="md:flex md:items-center md:justify-center md:w-1/2 md:bg-[#c2c6cc] md:dark:bg-[#191919]"
  >
    <div class="px-6 py-6 md:px-8 md:py-0">
      <h2
        class="text-lg font-bold text-[#c2c6cc] dark:text-white md:text-gray-100"
      >
        Busca todos tus certificados por <span
          class="text-primary dark:text-primary md:text-primary">cédula</span
        >
      </h2>
      <p class="mt-2 text-sm text-gray-600 dark:text-gray-400 md:text-gray-400">
        Consulta todos los certificado que realizaste solo con tu número de
        cédula.
      </p>
    </div>
  </div>

  <div class="flex items-center justify-center pb-6 md:py-0 md:w-1/2">
    <form id="modal-form">
      <div
        class="flex flex-col p-1.5 overflow-hidden border rounded-lg dark:border-gray-600 lg:flex-row dark:focus-within:border-primary focus-within:ring focus-within:ring-opacity-40 focus-within:border-primary focus-within:ring-primary"
      >
        <input
          id="modal-input"
          class="px-6 py-2 text-[#c2c6cc] placeholder-gray-500 bg-white outline-none dark:bg-[#191919] dark:placeholder-gray-400 focus:placeholder-transparent dark:focus:placeholder-transparent"
          type="text"
          name="search"
          placeholder="Ingresa número de cédula"
          aria-label="Enter your email"
          required
        />

        <button
          type="button"
          class="py-3 px-5 text-base font-medium text-center text-[#252627] hover:text-white rounded-sm bg-[#fcb316] hover:bg-[#fcb316]/60 border border-primary hover:border-white focus:ring-4 focus:ring-blue-300 dark:focus:ring-blue-900"
          aria-haspopup="dialog"
          aria-expanded="false"
          aria-controls="hs-vertically-centered-scrollable-modal"
          data-hs-overlay="#hs-vertically-centered-scrollable-modal"
        >
          Ir
        </button>
      </div>
    </form>
  </div>

  <div
    id="hs-vertically-centered-scrollable-modal"
    class="hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto pointer-events-none"
    role="dialog"
    tabindex="-1"
    aria-labelledby="hs-vertically-centered-scrollable-modal-label"
  >
    <div
      class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-lg sm:w-full m-3 sm:mx-auto h-[calc(100%-3.5rem)] min-h-[calc(100%-3.5rem)] flex items-center"
    >
      <div
        class="w-full max-h-full overflow-hidden flex flex-col bg-white border shadow-sm rounded-xl pointer-events-auto dark:bg-neutral-800 dark:border-neutral-700 dark:shadow-neutral-700/70"
      >
        <div
          class="flex justify-between items-center py-3 px-4 border-b dark:border-neutral-700"
        >
          <h3
            id="hs-vertically-centered-scrollable-modal-label"
            class="font-bold text-gray-800 dark:text-white"
          >
            Tus Certificados
          </h3>
          <button
            type="button"
            class="size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-800 hover:bg-gray-200 focus:outline-none focus:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-700 dark:hover:bg-neutral-600 dark:text-neutral-400 dark:focus:bg-neutral-600"
            aria-label="Close"
            data-hs-overlay="#hs-vertically-centered-scrollable-modal"
          >
            <span class="sr-only">Close</span>
            <svg
              class="shrink-0 size-4"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M18 6 6 18"></path>
              <path d="m6 6 12 12"></path>
            </svg>
          </button>
        </div>
        <div class="p-4 overflow-y-auto">
          <div class="space-y-4">
            <div>
              <h3
                id="nombre-usuario"
                class="text-lg font-semibold text-gray-800 dark:text-white"
              >
                Cargando...
              </h3>
              <p class="mt-1 text-gray-800 dark:text-neutral-400">
                Motivate teams to do their best work. Offer best practices to
                get users going in the right direction. Be bold and offer just
                enough help to get the work started, and then get out of the
                way. Give accurate information so users can make educated
                decisions. Know your user's struggles and desired outcomes and
                give just enough information to let them get where they need to
                go.
              </p>
            </div>
          </div>
        </div>
        <div
          class="flex justify-end items-center gap-x-2 py-3 px-4 border-t dark:border-neutral-700"
        >
          <button
            type="button"
            class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-sm border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 focus:outline-none focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700 dark:focus:bg-neutral-700"
            data-hs-overlay="#hs-vertically-centered-scrollable-modal"
          >
            Cerrar
          </button>
          <button
            id="modal-button"
            type="button"
            class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-sm border border-transparent bg-primary text-secondary hover:bg-[#ffd16f] focus:outline-none focus:bg-[#ffd16f] disabled:opacity-50 disabled:pointer-events-none"
          >
            Ingresar al campus
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const modalInput = document.getElementById("modal-input");
    const modalButton = document.getElementById("modal-button");
    
    modalButton.addEventListener("click", () => {
      const id = modalInput.value;
      console.log("modalimput value: ", modalInput.value);
      

      async function fetchUserData(id) {
        try {
          const response = await fetch(
            `https://certificados-backend.onrender.com/api/certificates/${id}`,
          );

          if (!response.ok) {
            throw new Error("Error al obtener los datos del usuario");
          }

          let userData = await response.json();
          console.log(userData);
        } catch (err) {
          console.log(
            "Error al obtener los datos. Verifica el número de cédula o código: ",
            err,
          );
        }
      }

      // Llamamos a la función fetchUserData con el id
      fetchUserData(id);
    });
  });
</script>

